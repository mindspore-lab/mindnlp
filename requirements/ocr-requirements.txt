# Qwen2-VL OCR 微调功能依赖配置
# 
# 用途：
#   - LoRA/QLoRA 微调
#   - 模型评估（CER/WER）
#   - 推理使用

# ============================================================================
# 核心依赖
# ============================================================================

# 基础深度学习框架
torch>=2.0.0
transformers>=4.37.0

# 高效微调
peft>=0.7.0

# 量化支持（QLoRA）
bitsandbytes>=0.41.0

# 数据处理
datasets>=2.14.0

# 训练加速
accelerate>=0.25.0

# ============================================================================
# OCR 特定依赖
# ============================================================================

# 图片处理
Pillow>=9.0.0

# 评估指标
editdistance>=0.6.2

# ============================================================================
# NPU 支持（昇腾）
# ============================================================================

# torch_npu 需要根据具体环境手动安装
# 安装方法：https://www.hiascend.com/software/cann

# ============================================================================
# 可选依赖
# ============================================================================

# TensorBoard 可视化
tensorboard>=2.14.0

# 进度条
tqdm>=4.65.0

# JSON 处理
# （Python 标准库已包含）

# ============================================================================
# 开发依赖
# ============================================================================

# 测试
pytest>=7.2.0

# 代码格式化
black>=23.0.0

# 类型检查
mypy>=1.0.0
#
# 安装方式：
#   pip install -r requirements/ocr-requirements.txt
#
# 独立环境配置（推荐用于真实模型测试）：
#   conda create -n qwen2vl_test python=3.10 -y
#   conda activate qwen2vl_test
#   pip install -r requirements/ocr-requirements.txt

# ============================================================================
# 核心依赖（必需）
# ============================================================================

# PyTorch GPU 版本（CUDA 11.8，推荐）
# 安装命令: pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
#
# 其他 CUDA 版本:
# CUDA 12.1: --index-url https://download.pytorch.org/whl/cu121
# CUDA 12.4: pip install torch torchvision torchaudio (默认最新)
# CPU 版本: --index-url https://download.pytorch.org/whl/cpu
#
# 华为 Ascend NPU 版本:
# pip install torch-npu (需要安装 CANN 工具包)
torch>=2.4.0
torchvision>=0.19.0
torchaudio>=2.4.0

# 华为 Ascend NPU 支持（可选，仅在 Ascend 服务器上需要）
# torch-npu>=2.1.0

# Transformers（需要 4.37.0+ 以支持 Qwen2VL）
transformers>=4.37.0
tokenizers>=0.15.0
safetensors>=0.4.3
accelerate>=0.25.0

# 图像处理
pillow>=10.0.0
numpy>=1.24.0,<2.0  # PyTorch 兼容性

# ============================================================================
# 测试依赖（必需）
# ============================================================================

pytest>=7.4.0
pytest-asyncio>=0.21.0

# ============================================================================
# 可选依赖（真实模型测试推荐）
# ============================================================================

qwen-vl-utils  # Qwen2-VL 官方工具包

# ============================================================================
# OCR 服务依赖（API 服务需要）
# ============================================================================

# 取消注释以下依赖来启用 API 服务
fastapi>=0.109.0
uvicorn[standard]>=0.27.0
pydantic>=2.0.0
pydantic-settings>=2.0.0  # Settings 配置管理
python-dotenv>=1.0.0  # .env 文件支持
python-multipart>=0.0.6
opencv-python>=4.8.0
requests>=2.31.0
pyyaml>=6.0
httpx>=0.26.0

# ============================================================================
# 监控和日志系统依赖
# ============================================================================

# 结构化日志
structlog>=23.1.0

# 分布式追踪 (OpenTelemetry)
opentelemetry-api>=1.20.0
opentelemetry-sdk>=1.20.0
opentelemetry-instrumentation-fastapi>=0.41b0
opentelemetry-exporter-otlp-proto-grpc>=1.20.0
opentelemetry-exporter-jaeger>=1.20.0

# 监控指标
prometheus-client>=0.19.0

# 性能分析
psutil>=5.9.0

# 依赖支持
Deprecated>=1.2.14
